\documentclass[a4paper,14pt]{article} %размер бумаги устанавливаем А4, шрифт 12пунктов
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel} %используем русский и английский языки с переносами
\usepackage{amssymb,amsfonts,amsmath,mathtext,enumerate,float,amsthm} %подключаем нужные пакеты расширений
\usepackage[pdftex,unicode,colorlinks=true,citecolor=black,linkcolor=black]{hyperref}
%\usepackage[pdftex,unicode,colorlinks=true,linkcolor=blue]{hyperref}
\usepackage{indentfirst} % включить отступ у первого абзаца
\usepackage[dvips]{graphicx} %хотим вставлять рисунки?
\graphicspath{{illustr/}}%путь к рисункам

\makeatletter
\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точку:
\makeatother %Смысл этих трёх строчек мне непонятен, но поверим "Запискам дебианщика"

\usepackage{geometry} % Меняем поля страницы.
\geometry{left=2cm}% левое поле
\geometry{right=1cm}% правое поле
\geometry{top=2cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле

\renewcommand{\theenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumii}{.\arabic{enumii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumiii}{.\arabic{enumiii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}% Меняем везде перечисления на цифра.цифра

\sloppy


\renewcommand\normalsize{\fontsize{14}{25.2pt}\selectfont}

\usepackage[backend=biber,style=gost-numeric,sorting=none]{biblatex}
\addbibresource{../common/notmy.bib}
\addbibresource{../common/my.bib}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{hypothesis}[theorem]{Hypothesis}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{observation}[theorem]{Observation}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{construction}[theorem]{Construction}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{problem}[theorem]{Problem}

\begin{document}
\renewcommand{\bibname}{Список цитированной литературы}
\renewcommand\refname{\bibname}
% !!!
% The text starts here

Avdeev N.N.

On existence and diameter bounds of integral point sets.
\footnote{
	This work was carried out at Voronezh State University and supported by the Russian Science
	Foundation under grant 19-11-00197.
}

\paragraph{Abstract.}
A point set $M$ in $m$-dimensional Euclidean space is called an integral point set if all the distances between the
elements of $M$ are integers, and $M$ is not situated on an $(m-1)$-dimensional hyperplane.
We improve the linear lower bound for diameter of planar integral point sets.
This improvement takes into account some results related to the Point Packing in a Square problem.
Then for arbitrary integers $m \geq 2$, $n \geq m+1$, $d \geq 1$
we give a construction of an integral point set $M$ of $n$ points in $m$-dimensional Euclidean space,
where $M$ contains points $M_1$ and $M_2$ such that distance between $M_1$ and $M_2$ is exactly $d$.



\section{Introduction}
Let $\mathbb{N}$ be the set of all positive integers and let $|M_1 - M_2|$ denote the Euclidean distance
between points $M_1$ and $M_2$ in a finite-dimensional space $\mathbb{R}^m$.
An \textit{integral point set} in $m$-dimensional Euclidean space is such a point set $M$ that all the distances between the
points of $M$ are integers and $M$ is not situated on an $(m-1)$-dimensional hyperplane.
Erd\"os and Anning proved~\cite{anning1945integral,erdos1945integral} that every integral point set consists of a finite number of points.
Taking the fact into account, we will denote the set of all integral point sets of $n$ points in $m$-dimensional Euclidean space with
$\mathfrak{M}(m,n)$ (following the notation of~\cite{our-vmmsh-2018}).
The symbol $|M|$ will be used for cardinality of $M$, i.e. the quantity of points in $M$ in our case.

For every finite point set, its diameter is naturally defined as
\begin{equation}
	\operatorname{diam} M = \max_{A,B\in M} |A-B|
	.
\end{equation}
The next emerging question is: how the diameter of an integral point set depends on its cardinality?
One can easily see that every $M\in\mathfrak{M}(m,n)$ with $\operatorname{diam} M = h$
can be dilated to $M_p\in\mathfrak{M}(m,n)$ with $\operatorname{diam} M = ph$
for every $p\in\mathbb{N}$.
So, the question above should be rephrased:
how \textit{the least possible} diameter of an integral point set depends on its cardinality?
To answer it, the following function was introduced~\cite{kurz2008bounds,kurz2008minimum}:
\begin{equation}
	d(m,n) = \min_{M\in\mathfrak{M}(m,n)} \operatorname{diam} M = \min_{M\in\mathfrak{M}(m,n)} \max_{A,B\in M} |A-B|
	.
\end{equation}
We also refer to~\cite{kurz2008bounds} for a list of known exact values of $d(m,n)$
and estimations; in the present paper, the case of $m=2$ will mostly be in the focus.

The most significant breakthrough on the planar case was done by Solymosi~\cite{solymosi2003note},
who proved that $cn \leq d(2,n)$ for a sufficiently small constant $c$.
Following the details of Solymosi's proof carefully,
one can know out that the inequality holds at least for $c = 1/24$.
(See~\cite[Exercise 2.6]{garibaldi2005erdos} for some remarks.)
The constant was improved in~\cite{our-mz-rus} to $1/8$ for all $n$ and in~\cite{our-vmmsh-2018}
to $3/8$ for sufficiently big $n$.

The paper~\cite{solymosi2003note} contained one more interesting result.
Let us define a function which is ``dual'' to $d(m,n)$ in some sense:
\begin{equation}
	l(m,n) = \min_{M\in\mathfrak{M}(m,n)} \min_{A,B\in M} |A-B|
	.
\end{equation}
Solymosi proved that $l(2,n)\leq 2$.

In the present paper we improve Solymosi's results:
firstly, we obtain a greater constant $c$ in Theorem (TODO: the number of theorem and the exact constant),
using the combined approach with the Point Packing in a Square problem;
then, we prove that $l(m,n)=1$ for all possible $m$ and $n$.

\section{Lower bound for the diameter}

In this section,
we improve a better lower bound for minimum diameter of planar integral point sets by
involving Point Packing in a Square problem.
Below we introduce the problem, basic notions and results.

\begin{problem}[Point Packing in a Square (PPS)\cite{locatelli2002packing,costa2013valid}]
	\label{problem:PPS}
	Given an integer $k > 1$, place $k$ points in the unit square $U = [ 0 , 1 ]^2$ such that their
	minimum pairwise distance $m$ is maximal.
\end{problem}

\begin{definition}
	For each $k > 1$, the corresponding maximal distance $m$ from Problem~\ref{problem:PPS}
	is called the $k$-th PPS coefficient and denoted by $\varphi_k$.
\end{definition}
So, it's impossible to place $k$ points in a unit square such that each pairwise distance of the points is greater than $\varphi_k$.


\begin{theorem}
	\label{thm:varphi_k_bounds}
	\cite{costa2013valid}
	For every $k\geq 2$ the following inequality holds:
	\begin{equation*}
		\sqrt{\frac{2}{k\sqrt{3}}}
		\leq
		\varphi_k
		\leq
		\frac{1}{k-1} +
		\sqrt{
			\frac{1}{(k-1)^2}
			+
			\frac{2}{(k-1)\sqrt{3}}
		}
	\end{equation*}
\end{theorem}


For building the bound, we also require the following results and notions from~\cite{our-vmmsh-2018}.

\begin{lemma}
	\cite[Lemma 4]{our-vmmsh-2018}
	\label{lem:square_container}
	Let $M\in\mathfrak{M}(2,n)$, $\operatorname{diam} M = d$.
	Then $M$ is situated in a square with side length $d$.
\end{lemma}

\begin{definition}
	\textit{Cross} for points $M_1$ and $M_2$, denoted by $cr(M_1,M_2)$, is union of two straight lines:
	the line which the points $M_1$ and $M_2$ are situated on,
	and the bisector of line segment $M_1 M_2$.
\end{definition}

\begin{lemma}
	\label{lem:intervals_cross}
	If \textbf{open} line segments $M_1 M_2$ and $M_3 M_4$ do not intersect,
	%$M_1 \neq M_2$, $M_3 \neq M_4$,
	then the set $cr(M_1,M_2) \cap cr(M_3,M_4)$ is either a straight line or contains not more than 4 points.
\end{lemma}

\begin{lemma}
	\label{lemma:quadr_diag_edges}
	Let $ABCD$ be a convex quadrilateral on the plane.
	Then $\max\{AC,BD\}>\min\{AB,BC,CD,DA\}$,
	i.e. at least one diagonal is greater than at least one side.
\end{lemma}


Basing on the exact values of $d(2,n)$ for $ 3 \geq n\leq 122$ and the estimate $d(2,123)>10000$
\cite{kurz2008bounds}, we derive
\begin{observation}
	The inequality
	\begin{equation}
		d(2,n) \geq 3^{1/4}\cdot2^{-3/2} \cdot n
	\end{equation}
	holds for $4 \leq n \leq 21491$.
\end{observation}



We can improve the constant in Theorem~(TODO: ref) if new exact values of $d(2,n)$ are found;
however, the obtained constant is bounded by $3^{1/4}\cdot2^{-3/2}$.
To be precise, we have the following

\begin{theorem}
	For every $\varepsilon > 0$ there exists such a number $k_0$, that for every $k>k_0$ we have the inequality
	\begin{equation}
		d(2,k) \geq k\cdot(3^{1/4}\cdot2^{-3/2} - \varepsilon)
		.
	\end{equation}
\end{theorem}



\section{Constructing integral point sets}

\begin{definition}
	A set $M\in\mathfrak{M}(2,n)$ is called \textit{facher}
	if $M$ consists of $n-1$ points on a straight line
	and one point out of the line.
\end{definition}

\begin{definition}
	A set $M\in\mathfrak{M}(m,n)$ is called \textit{optimal}
	if $\operatorname{diam}M=d(m,n)$.
\end{definition}

\begin{definition}
	\cite{kurz2005characteristic}
	A \textit{characteristic} of an integral point set $M$ is such a squarefree number $q$,
	that for any points $M_1, M_2, M_3 \in M$ the area of triangle $M_1 M_2 M_3$
	is $p\sqrt{q}$, where $p$ is rational.
\end{definition}
For given integral point set, the characteristic is determined uniquely.

Facher sets are the simplest ones of planar integral point sets.
It is shown that for $9\leq n \leq 122$ all the optimal sets are facher~\cite{kurz2008minimum}.
For every cardinality $n$ and every characteristic $q$
there exists a facher set $M\in\mathfrak{M}(2,n)$ with characteristic $q$~\cite[Theorem 5]{our-vmmsh-2018}.
In~\cite{antonov2008maximal}, the facher sets of characteristic 1 are called \textit{semi-crabs} and investigated.

For every integer $n\geq 3$ Solymosi~\cite{solymosi2003note} gives a construction of a facher integral point set
$M\in\mathfrak{M}(2,n)$
such that equality $|M_1 - M_2| = 2$ holds for some $M_1, M_2 \in M$.
The constructed set has both odd and even distances.

Now we will improve the Solymosi's result.

\begin{construction}
	\label{con:planar_set_with_minimeter_1}
	Let us choose a positive integer $k > 1$ and take
	\begin{equation}
		a = 2^{2^k} - 1
		.
	\end{equation}
	Then
	\begin{equation}
		\label{eq:a_equiv_3_mod_4}
		a \equiv 3 \mod 4
	\end{equation}
	and, moreover,
	\begin{multline}
		a = \left(2^{2^{k-1}}\right)^2 - 1
		=
		\left(2^{2^{k-1}} + 1\right) \left(2^{2^{k-1}} - 1\right)
		=
		\\=
		\left(2^{2^{k-1}} + 1\right) \left(2^{2^{k-2}} + 1\right) \cdot ... \cdot \left(2^{2^1} + 1\right) \left(2^2 - 1\right)
		.
	\end{multline}
	We take $d_j = 2^{2^j} + 1$ for $1 \leq j \leq k-1$.
	Then $d_j \equiv 1 \mod 4$.

	Let $c_J = \prod_{j\in J} d_j$ for every subset of indexes $J\subset I = \{1,2,...,k-1\}$
	(and  $c_\varnothing = 1$).
	We get
	\begin{equation}
		\label{eq:c_J_equiv_1_mod_4}
		c_J\equiv 1 \mod{4}
	\end{equation}
	and, moreover, $a$ is divisible by $c_J$.


	From~\eqref{eq:a_equiv_3_mod_4} and~\eqref{eq:c_J_equiv_1_mod_4} we obtain $a/c_J \equiv 3 \mod 4$.
	Let $b_J = (c_J - a/c_J)/2$, then $b_J \equiv 1 \mod 2$.
	Let us further take $g_J = (c_J + a/c_J)/2$, then $g_J \equiv 0 \mod 2$.

	We will now define the coordinates of the points as following:
	\begin{equation}
		M_{J\pm} =\left(\pm\frac{b_J}{2}, 0\right)
		,
		~~
		N   =\left(0, \frac{\sqrt{a}}{2}\right)
		.
	\end{equation}
	Then the distances are:
	\begin{multline}
		|N - M_{J\pm}|
		=
		\left(\frac{b_J^2}{4} + \frac{a}{4}\right)^{1/2}
		=
		\frac{1}{2}\left(\left(\frac{c_J - a/c_J}{2}\right)^2 + a\right)^{1/2}
		=
		\\=
		\frac{1}{2}\left( \left(\frac{c_J}{2}\right)^2 - \frac{a}{2} + \left(\frac{a}{c_j}\right)^2 + a\right)^{1/2}
		=
		\frac{1}{2}\left( \left(\frac{c_J}{2}\right)^2 + \frac{a}{2} + \left(\frac{a}{c_j}\right)^2    \right)^{1/2}
		=
		\\=
		\frac{1}{2}\left(\left(\frac{c_J + a/c_J}{2}\right)^2\right)^{1/2}
		=
		\frac{1}{2}\left(\frac{c_J + a/c_J}{2}\right)
		=
		\frac{g_J}{2}
		\in\mathbb{N}
		,
	\end{multline}
	\begin{equation}
		|M_{J_1 \pm} - M_{J_2 \pm}|
		=
		\left|\frac{b_{J_1}}{2} \pm \frac{b_{J_2}}{2}\right|
		=
		\left|\frac{b_{J_1} \pm b_{J_2}}{2}\right|
		\in\mathbb{N}
		.
	\end{equation}
	In particular, for $H = \{k-1\}$ we obtain $C_H = 2^{2^{k-1}}+1$ and
	\begin{equation}
		b_H =
		\left( 2^{2^{k-1}}+1 - \frac{a}{2^{2^{k-1}}+1} \right)/2
		=
		\left(2^{2^{k-1}}+1 - \left(  2^{2^{k-1}}-1 \right) \right)/2
		=
		1
		.
	\end{equation}
	Then, one of the distances is
	\begin{equation}
		|M_{H+} - M_{H-}|
		=
		\left|\frac{b_{H}}{2} - \frac{-b_{H}}{2}\right|
		=
		\left|\frac{1}{2} - \frac{-1}{2}\right|
		= 1
		.
	\end{equation}

	So, $M = \{ M_{J\pm}, N\}$ is indeed a planar integral point set of $2^k+1$ points,
	and distance 1 occurs in $M$.
	Reminding that $k$ can be taken arbitrary large, we conclude that we can construct
	a planar integral point set of arbitary large count of points so that the distance 1 occurs in that set.
\end{construction}


TODO: recalculate the cardinality.

\begin{remark}
	Applying Construction~\ref{con:planar_set_with_minimeter_1} to $k=1$ literally,
	we get $a = 3$, $I=\varnothing$, $b_\varnothing = -1$ and then
	obtain a right triangle with side length 1.
	This triangle is obviously the optimal set in $\mathfrak{M}(2,3)$.
\end{remark}

\begin{remark}
	For $k=2$ in Construction~\ref{con:planar_set_with_minimeter_1},
	we obtain the optimal set in $\mathfrak{M}(2,5)$ presented in~\cite[Fig. 1]{harborth1993upper}.
	If we truncate one point from it,
	then we get one of the two optimal sets in $\mathfrak{M}(2,4)$.
\end{remark}

\begin{hypothesis}
	Every set $M\in\mathfrak{M}(2,n)$, $n\geq 6$, such that for some $M_1,M_2$ equality $|M_1 - M_2|=1$ holds,
	is not optimal.
\end{hypothesis}

%Now we need two more definitions.
\begin{definition}
	\cite{antonov2008maximal}
	A set $M\in \mathfrak{M}(m,n)$ is \textit{maximal},
	if there is no such a set $M'\in \mathfrak{M}(m,n+1)$
	that $M \subsetneq M'$.
\end{definition}

%\begin{definition}
%	A set $M\in \mathfrak{M}(m,n)$ is \textit{submaximal},
%	if there is only one maximal integral point set $M'\in \mathfrak{M}(m,n+1)$,
%	such that $M \subset M'$.
%\end{definition}

Summing up Construction~\ref{con:planar_set_with_minimeter_1} above with~\cite[lemma 3 and proposition 6]{our-vmmsh-2018}
and~\cite[Section 6]{antonov2008maximal},
we obtain the following

TODO: should I write translated version of the results here?

\begin{theorem}
	\label{thm:minimeter_1_planar}
	For every $n\geq 3$ there is a planar intergal set $M$ of $n$ points
	such that for some $M_1,M_2 \in M$ equality $|M_1 - M_2|=1$ holds.
	This set consists of $n-1$ points, including $M_1$ and $M_2$, on a straight line and one point out of the line.

	And vice versa, if $M$ is a planar integral point set of $n$ points
	such that for some $M_1,M_2 \in M$ equality $|M_1 - M_2|=1$ holds,
	then $M$ consists of $n-1$ points, including $M_1$ and $M_2$, on a straight line,
	and one point out of the line, on the bisector of line segment $M_1 M_2$.
	There is only one maximal integral point set $M' \supseteq M$,
	and the bisector is the axis of symmetry for $M'$.
	Moreover, if $n > 3$, then the distance 1 occurs in $M$ (and $M'$) only once.
\end{theorem}

Using the ``blowing up'' procedure described in~\cite[theorem 1.3]{kurz2008bounds},
we can construct an integral point set $M$ in $m$-dimensional Euclidean space, $m\geq 3$,
with distance 1 occuring in it.
If we have an integral point set with distance 1 occuring,
then we can easily dilate it to turn 1 into the desired distance.
These facts, together with Theorem~\ref{thm:minimeter_1_planar}, give the following

\begin{theorem}
	For arbitrary integers $m \geq 2$, $n \geq m+1$, $d \geq 1$
	there exists $M\in\mathfrak{M}(m,n)$,
	such that for some $M_1, M_2\in M$ equality $|M_1 - M_2| = d$ holds.
\end{theorem}

TODO: construction with unique minimum edge?

\begin{definition}
	We will call an integral point set $M$ \textit{irreducible}, if the greatest common divisor
	of all the distances occuring in $M$ is 1.
\end{definition}

If an integral point set is irreducible,
then it cannot be squashed to an integral point set of the same power and structure but smaller diameter.

\begin{hypothesis}
	\label{hyp:irreducible_planar}
	For every $m \geq 2$, $n \geq m+1$, $d \geq 1$ there exists an \textbf{irreducible}
	integral point set $M$ of $n$ points in $m$-dimensional Euclidean space
	where $M$ contains points $M_1$ and $M_2$ such that distance between $M_1$ and $M_2$ is exactly $d$.
\end{hypothesis}

For $m \geq 3$, Hypothesis~\ref{hyp:irreducible_planar} can be easily proved:
indeed, we can just take a facher integral point set according to Construction~\ref{con:planar_set_with_minimeter_1}
with sufficiently large height and then apply the ``blowing up'' procedure described in~\cite[Theorem 1.3]{kurz2008bounds},
replacing the out-of-line point with an $(m-2)$-dimensional simplex with proper side length.
That simplex will consist of $m-1$ points;
we can throw out up to all points $M_J$, except the two points with distance 1.
So, the set consists of $m+1$ or more points and has distance 1 occuring in it.
As distance 1 occurs in the obtained set, it is irreducible.

So, Hypothesis~\ref{hyp:irreducible_planar} needs proof only for $m=2$.

\section{Acknowledgements}
Author thanks Prof. E.M. Semenov for the fruitful discussion and ideas
and A.S. Chervinskaia for the idea of using the term ``facher'' and other linguistic advices.


\printbibliography

\end{document}
